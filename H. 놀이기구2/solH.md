## 놀이기구 2

앞선 문제와의 차이점은 Parallel binary serach를 사용할 수 없다는 것입니다. 때문에 이 문제를 풀기 위해서는 첫번째 날부터 K번째 날까지 시뮬레이션을 하면서, 각 날마다 Q개의 질문 중 몇개가 처음으로 만족되었는지 알아내야 합니다! 역시 나이브하게 하면 O(QK)의 시간으로 해결 가능하지만, 시간제한상 충분치 않습니다. O(QK)가 의미하는 바는, 각 질문에 대해 K번씩 만족되었는지 검사를 한다는 뜻이죠. 이제부터 쓸데없는 검사 횟수를 줄이도록 해보겠습니다. 아이 i의 키를 Ai라고 한다면, 임의의 질문은
Ai + Aj >= C (C는 상수) 라는 부등식으로 변환됩니다. 그리고 여기서 중요한 사실은 Ai, Aj중 하나는 C/2 이상이어야 부등식을 만족시킬 수 있다는 것입니다. 즉 Ai, Aj 모두 C/2 미만일 경우 그 질문은 검사를 할 필요가 없게 됩니다. 따라서 각 질문에 대해 log2C 번 정도의 검사만으로도 충분하다는 것을 알 수 있습니다. 구체적인 구현은 우선순위 큐(Priority queue) 등을 이용해 구현할 수 있으며, 시간복잡도는 O(Q log2키제한 + K)입니다.
